resources:
- name: azs-concourse
  type: git
  source: 
    uri: https://github.com/bottkars/azs-concourse
    branch: master
    private_key: ((azs-resource-key.private_key))

- name: az-cli-image
  type: docker-image
  source: 
    repository: microsoft/azure-cli

- name: cert
  type: git
  source:
    uri: git@github.com:bottkars/platform-automation.git
    private_key: ((plat-auto-pipes-deploy-key.private_key))
    branch: master
jobs:
- name: test-azcli 
  plan:
  - get: azs-concourse
  - get: az-cli-image
  - task: test-azcli
    image: az-cli-image
    file: azs-concourse/ci/tasks/test-task.yml

- name: run-azcli
  plan:
  - get: cert
  - get: azs-concourse
  - get: az-cli-image
  - task: task2
    image: az-cli-image
    file: azs-concourse/ci/tasks/task2.yml  
    params:
      CA_CERT: cert/root.pem


